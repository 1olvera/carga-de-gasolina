<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   
    <!-- Bootstrap CSS -->
    
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <style>
   h3, h4, h5, h6 {text-align: center;} 

  .nav-link{
      cursor:pointer;
     .form-elegant .font-small {
      font-size: 0.8rem; }

     .form-elegant .z-depth-1a {
     -webkit-box-shadow: 0 2px 5px 0 rgba(55, 161, 255, 0.26), 0 4px 12px 0 rgba(121, 155, 254, 0.25);
     box-shadow: 0 2px 5px 0 rgba(55, 161, 255, 0.26), 0 4px 12px 0 rgba(121, 155, 254, 0.25); }

    .form-elegant .z-depth-1-half,
    .form-elegant .btn:hover {
     -webkit-box-shadow: 0 5px 11px 0 rgba(85, 182, 255, 0.28), 0 4px 15px 0 rgba(36, 133, 255, 0.15);
     box-shadow: 0 5px 11px 0 rgba(85, 182, 255, 0.28), 0 4px 15px 0 rgba(36, 133, 255, 0.15); }
  }

  /*#loading {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 10000;
      width: 100vw;
      height: 100vh;
      background-color: rgba(255,255,255,0.9);
  }*/
    
  .nav {
    background-color: #ffffff !important;
  }

  *{
   box-sizing: border-box;
  }

  body {
  font: 16px Arial;  
  }
 
  .own-set{
   padding: 10px;
   width: 500px;
   
  }

  div.ui-datepicker, .ui-datepicker input{font-size:110%;}

  label.required::before {
  content: '*';
  margin-right: 4px;
  color: red;
  } 

  #divMenuUraianKerja{
      border: 1px solid rgba(0,0,0,0.2);
      padding: 20px;
      margin-left:10px;
      margin-right:10px;
      margin-top: 15px;
      background-color: #F2F2E5;
      font-family: 'Prompt';
   }
       
  </style>
  
  </head>
  <body>

    
     <div style="max-width:1000px;margin:20px auto;"> 
     <div id = "maincontainer" class="container"> 
      
       <h5 style="color:#0552A6">Carga de Gasolina</h5>
       
      
          
     <div id="loading" class="d-flex justify-content-center align-items-center invisible" style="color:#F0530A;">
       <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
       Please wait...
     </div>  
     <div id="app">
      
         </div>
      
        
     </div><!-- Close container -->
     </div> <!-- Close userform -->

     <!-- <div id = "loading" class="d-flex justify-content-center align-items-center invisible">
       <div class="spinner-grow text-info" style="width: 3rem; height: 3rem;" role="status">
       <span class="sr-only">Loading...</span>
       </div>
       <div>ESPERA ...</div>
     </div> -->    
     

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    
    
  <!--Autocomplete & Calendar JQuery--> 
  <link rel="stylesheet" href="//code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="/resources/demos/style.css">
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
  <!--Autocomplete & Calendar JQuery--> 
  
  <?!=include('utility-js')?>
  <script> 
  
  //var disabledDaysArray = [];
  //var gUser = "", gDrive = "";   


  function validate(){
    let fieldsToValidate = document.querySelectorAll("#userform input,#userform textarea,#userform select");      
     
      Array.prototype.forEach.call(fieldsToValidate,function(el){
       if(el.checkValidity()){
         el.classList.remove("is-invalid");
       }else{
         el.classList.add("is-invalid");
        }
      });      
    
      return Array.prototype.every.call(fieldsToValidate,function(el){
        return el.checkValidity();
      });
  }

//-----------------------------------------------------------------------------------//
//---------------   End Check Validate Function           ---------------------------//
//-----------------------------------------------------------------------------------//  

//-----------------------------------------------------------------------------------//
//---------------     Date Picker Change Function        ----------------------------//
//-----------------------------------------------------------------------------------//     

  function resetTimeOption(){    
    var optionHTML = '<option disabled selected value="">Select Time</option>';
    optionHTML += '<option value="9:00">9:00</option>';
    optionHTML += '<option value="10:00">10:00</option>';
    // optionHTML += '<option value="13:00">13:00</option>';
    // optionHTML += '<option value="14:00">14:00</option>';
    // optionHTML += '<option value="15:00">15:00</option>';
    // optionHTML += '<option value="16:00">16:00</option>';
    // optionHTML += '<option value="17:00">17:00</option>';
    // optionHTML += '<option value="18:00">18:00</option>';
    // optionHTML += '<option value="19:00">19:00</option>';

    document.getElementById('time').innerHTML = optionHTML;
    
  }


  function resetDriveOption(){ 
    document.getElementById('unidad').disabled = false;   
    var optionHTML = '<option disabled selected value="">Unidad</option>';
    optionHTML += '<option value="464">U-464</option>';
    optionHTML += '<option value="730">U-730</option>';
    optionHTML += '<option value="742">U-742</option>';
    optionHTML += '<option value="767">U-767</option>';
    optionHTML += '<option value="772">U-772</option>';
    optionHTML += '<option value="913">U-913</option>';
    optionHTML += '<option value="430">U-430</option>';
    // optionHTML += '<option value="15:00">15:00</option>';
    // optionHTML += '<option value="16:00">16:00</option>';
    // optionHTML += '<option value="17:00">17:00</option>';
    // optionHTML += '<option value="18:00">18:00</option>';
    // optionHTML += '<option value="19:00">19:00</option>';

    document.getElementById('unidad').innerHTML = optionHTML;
    
  }
  function setTimeSelector(timeArray){
     
    if(timeArray && timeArray !== undefined && timeArray.length != 0){         
      for(let i=0; i<timeArray.length; i++){
         const foundOption = [...document.querySelectorAll(".select-time option")] 
               .find(o =>  timeArray.includes(o.value));

          if(foundOption){
             foundOption.remove();           
          }        
      }
    }
    else{
       resetTimeOption();       
    }
    document.getElementById("display_error").innerHTML = "Please select a time!";
    document.getElementById("display_error").style = "color:green";    
    setTimeout(function(){
           document.getElementById("display_error").innerHTML = "";           
    },3000);    
    document.getElementById("save-btn").disabled = false;
    document.getElementById("time").disabled = false; 
  }
  function setUsuarioSelector(timeArray){
     
    if(timeArray && timeArray !== undefined && timeArray.length != 0){         
      for(let i=0; i<timeArray.length; i++){
         const foundOption = [...document.querySelectorAll(".select-usuario option")] 
               .find(o =>  timeArray.includes(o.value));

          if(foundOption){
             foundOption.remove();           
          }        
      }
    }
    else{
       resetUserOption();       
    }
    document.getElementById("display_error").innerHTML = "Please select a user!";
    document.getElementById("display_error").style = "color:green";    
    setTimeout(function(){
           document.getElementById("display_error").innerHTML = "";           
    },3000);    
    document.getElementById("save-btn").disabled = false;
    document.getElementById("date").disabled = false; 
  }   


  function afterButtonClick(){
      if(validate()){
        document.getElementById("save-btn").disabled = true;
        Swal.fire({
                     position: 'center',
                     icon: 'warning',
                     title: 'Agregar registro',
                     text: "Espere por favor...",
                     showConfirmButton: false
                     //timer: 20000
                  })
        document.getElementById("display_error").innerHTML = "Agregar registro...";
        document.getElementById("display_error").style = "color:green"; 
        loadingStart();        
             
        let custID = "ex_user";
        let user = document.getElementById("usuario");
        let car = document.getElementById("unidad");        
        let litro = document.getElementById("litro");
        let km = document.getElementById("kilo");
        let admin = "customer";        
        
        gUser = usuario.value; 
        gDrive = unidad.value;        
        
        let rowData = {                      
                      custID:custID, 
                      user:usuario.value,                     
                      car:unidad.value,                     
                      litro:litro.value,                     
                      km:kilo.value,
                      precio:precio.value,                      
                      admin:admin
                      };
        google.script.run.withSuccessHandler(function(return_string){         
          if(return_string == "success"){
                Swal.fire({
                position: 'center',
                icon: 'success',
                html: '<div style = "font-size:22px;color:green;">Success, por favor guarde el TT en su sobre</div>'+
                '<h5>Carga de Gasolina</h5>'+
                '<div style="font-size:17px;color:black;">'+"Usuario "+rowData.user+" unidad "+rowData.car+" litros "+rowData.litro+'</div>',             
                //showConfirmButton: true,
                timer: 100000
                }) 
                loadAddView();
                document.getElementById("display_error").innerHTML = "Success!";
                document.getElementById("display_error").style = "color:green";
                setTimeout(function(){
                    document.getElementById("display_error").innerHTML = "";                  
                },10000);
          }
          else{
               Swal.fire({
                position: 'center',
                icon: 'error',
                html: '<div style = "font-size:20px;color:red;">  , Ups, algo salio mal, contacta al administrador!</div>'                
                //timer: 10000
                }) 
                loadAddViewOnFail();                
                document.getElementById("display_error").innerHTML = "Ups, algo salio mal, contacta al administrador!";
                document.getElementById("display_error").style = "color:red";
                setTimeout(function(){
                    document.getElementById("display_error").innerHTML = "";                  
                },10000); 
          }  
            document.getElementById("save-btn").disabled = false;
        }).addNewRow(rowData);       
      
      }else{         
         
         document.getElementById("display_error").innerHTML = "¡Por favor complete toda la información requerida!";
         document.getElementById("display_error").style = "color:red";
         setTimeout(function(){
           document.getElementById("display_error").innerHTML = "";
         },5000);
         $('#errorNotification').toast('show');
      }
  }

//-----------------------------------------------------------------------------------//
//---------------         End Add Booking Function       ----------------------------//
//-----------------------------------------------------------------------------------//   
        document.addEventListener("DOMContentLoaded",loadAddView);       
         
</script>

</body>
</html>
